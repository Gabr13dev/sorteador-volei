<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Sorteio Balanceado de Times â€” HTML/JS/CSS puros</title>
  <style>
    :root {
      --bg:#0f172a;         /* slate-900 */
      --card:#111827;       /* gray-900 */
      --muted:#94a3b8;      /* slate-400 */
      --text:#e5e7eb;       /* gray-200 */
      --accentA:#60a5fa;    /* blue-400 */
      --accentB:#f87171;    /* red-400 */
      --accentR:#facc15;    /* yellow-400 */
      --shadow: 0 10px 30px rgba(0,0,0,.35);
      --radius: 18px;
    }
    * { box-sizing: border-box }
    html, body { height: 100% }
    body {
      margin: 0; font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1000px 600px at 10% -10%, #1f2937 0, transparent 60%),
                  radial-gradient(800px 500px at 110% 10%, #1f2937 0, transparent 60%),
                  var(--bg);
      color: var(--text);
      display: grid; place-items: center; padding: 24px;
    }
    .app { width: min(1100px, 96vw); }
    header { display:flex; align-items:center; gap:14px; margin-bottom:20px; }
    .logo { width:42px; height:42px; border-radius:12px; display:grid; place-items:center; background:#0b1220; box-shadow: var(--shadow); }
    .logo span { font-size:22px; }
    h1 { font-size: clamp(20px, 2.6vw, 34px); margin: 0; letter-spacing:.2px }
    .muted { color: var(--muted) }

    .card { background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01));
            border:1px solid rgba(255,255,255,.08); border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow); }

    .controls { display:flex; flex-wrap:wrap; gap:12px; align-items:center; margin-bottom:20px }
    .btn { cursor:pointer; border:none; padding:12px 18px; border-radius:12px; font-weight:600; color:#0b1220; background:#e5e7eb; }
    .btn.primary { background: #a78bfa; color:#0b1220; }
    .btn:disabled { opacity:.6; cursor:not-allowed }

    textarea { width:100%; min-height:120px; background: rgba(255,255,255,.03); color: var(--text); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:12px; resize: vertical; }
    .hint { font-size:12px; color: var(--muted); margin-top:6px }

    .grid { display:grid; grid-template-columns: 1fr; gap:16px }
    @media (min-width: 800px) { .grid { grid-template-columns: 1fr 1fr; } }

    .team { border-left: 6px solid transparent }
    .team.a { border-left-color: var(--accentA); }
    .team.b { border-left-color: var(--accentB); }
    .team.r { border-left-color: var(--accentR); }

    .team h2 { margin:0 0 12px 0; display:flex; align-items:center; gap:10px; font-size: clamp(16px, 1.8vw, 22px) }
    .pill { padding:4px 10px; border-radius:999px; font-size:12px; font-weight:700; letter-spacing:.4px; color:#0b1220; }
    .pill.a { background: var(--accentA); }
    .pill.b { background: var(--accentB); }
    .pill.r { background: var(--accentR); }

    ul { list-style:none; margin:0; padding:0; display:grid; gap:8px }
    li { background: rgba(255,255,255,.03); border:1px solid rgba(255,255,255,.08); padding:12px 14px; border-radius:12px; display:flex; align-items:center; justify-content:space-between }

    .name { font-weight:600 }
    .tag { font-size:12px; color: var(--muted) }

    .drawer { overflow:hidden; transition: grid-template-rows 400ms ease; display:grid; grid-template-rows: 0fr; }
    .drawer.open { grid-template-rows: 1fr; }
    .drawer > div { min-height:0 }

    .fakebar { height:10px; border-radius:999px; background: linear-gradient(90deg, #0b1220, #0b1220) padding-box,
                 linear-gradient(90deg, var(--accentA), var(--accentB), var(--accentR)) border-box; border: 2px solid transparent; }

    .roll { display:flex; align-items:center; gap:8px; }
    .dot { width:10px; height:10px; border-radius:50%; background:#e5e7eb; opacity:.6; animation: blink 1.2s infinite; }
    .dot:nth-child(2){ animation-delay:.15s }
    .dot:nth-child(3){ animation-delay:.3s }
    @keyframes blink { 0%,80%,100%{ opacity:.1 } 40%{ opacity:1 } }

    footer { margin-top:16px; text-align:center; color:var(--muted); font-size:12px }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="logo"><span>ðŸŽ²</span></div>
      <div>
        <h1>Sorteio Balanceado de Times</h1>
        <div class="muted">Os times sÃ£o sorteados de verdade.</div>
      </div>
    </header>

    <section class="card" style="margin-bottom: 16px;">
      <label for="entradaNomes" class="muted">Cole/edite a lista de participantes (um por linha).</label>
      <textarea id="entradaNomes"></textarea>
      <div class="hint">Dica: o prÃ©-cadastro jÃ¡ conhece alguns nomes. VocÃª pode usar a lista completa ou tirar quem nÃ£o for jogar hoje.</div>
    </section>

    <section class="card">
      <div class="controls">
        <button id="btnSortear" class="btn primary">Sortear e equilibrar</button>
        <button id="btnReset" class="btn" disabled>Reiniciar</button>
        <span id="status" class="muted">Pronto para sortear.</span>
      </div>
      <div class="drawer" id="drawerLoading">
        <div>
          <div class="card" style="margin-bottom:12px">
            <div class="roll"><strong>Sorteando</strong> <span class="dot"></span><span class="dot"></span><span class="dot"></span></div>
          </div>
          <div class="fakebar"></div>
        </div>
      </div>
    </section>

    <section class="grid" id="times" style="display:none">
      <div class="card team a">
        <h2><span class="pill a">ðŸŸ¦ Time A</span></h2>
        <ul id="listaA"></ul>
      </div>
      <div class="card team b">
        <h2><span class="pill b">ðŸŸ¥ Time B</span></h2>
        <ul id="listaB"></ul>
      </div>
      <div class="card team r" style="grid-column: 1 / -1">
        <h2><span class="pill r">ðŸŸ¨ Reserva â€” entra no time que perder</span></h2>
        <ul id="listaR"></ul>
      </div>
    </section>

    <footer>HTML/JS/CSS puros â€¢ Balanceamento por notas (display sem notas)</footer>
  </div>

  <script>
    // ðŸ‘‰ PrÃ©-cadastro com notas (nÃ£o exibidas)
    const PRE_CADASTRO = [
      { nome: "Igor M", nota: 4.0 },
      { nome: "Joao", nota: 3.25 },
      { nome: "Gabriel", nota: 3.5 },
      { nome: "Larissa", nota: 2.5 },
      { nome: "Gisele", nota: 1.5 },
      { nome: "Leander", nota: 3.0 },
      { nome: "Fred", nota: 4.0 },
      { nome: "Madson", nota: 3.5 },
      { nome: "Kessia", nota: 3.5 },
      { nome: "Dumbo", nota: 3.5 },
      { nome: "Julia", nota: 2.5 },
      { nome: "Igor Triste", nota: 2.25 },
      { nome: "Lucas", nota: 2.5 },
    ];

    const NOTA_PADRAO = 2.8;

    const NOTAS = PRE_CADASTRO.reduce((acc, p) => (acc[p.nome.toLowerCase()] = p.nota, acc), {});

    const ui = {
      entradaNomes: document.getElementById('entradaNomes'),
      btnSortear: document.getElementById('btnSortear'),
      btnReset: document.getElementById('btnReset'),
      status: document.getElementById('status'),
      drawerLoading: document.getElementById('drawerLoading'),
      times: document.getElementById('times'),
      listaA: document.getElementById('listaA'),
      listaB: document.getElementById('listaB'),
      listaR: document.getElementById('listaR'),
    };

    function seedEntrada() {
      const nomes = PRE_CADASTRO.map(p => p.nome);
      ui.entradaNomes.value = nomes.join('');
    }

    function clearLists(){ ui.listaA.innerHTML = ''; ui.listaB.innerHTML=''; ui.listaR.innerHTML=''; }

    function toParticipantes(list) {
      const seen = new Set();
      const participantes = [];
      list.forEach(raw => {
        const nome = raw.trim();
        if(!nome) return;
        const key = nome.toLowerCase();
        if(seen.has(key)) return; // ignora duplicados
        seen.add(key);
        const nota = NOTAS[key] ?? NOTA_PADRAO;
        participantes.push({ nome, nota });
      });
      return participantes;
    }

    function sortearBalanceado(participantes) {
      // Embaralha levemente para dar aleatoriedade
      participantes = participantes.slice().sort(() => Math.random() - 0.5);
      // Ordena por nota desc para garantir equilÃ­brio na distribuiÃ§Ã£o
      participantes.sort((a,b) => b.nota - a.nota);

      const A = []; const B = [];
      let somaA = 0, somaB = 0;

      for (const p of participantes) {
        // regra: quem tem menor soma recebe o prÃ³ximo melhor
        // se empatar, decide aleatÃ³rio para variar
        if (somaA < somaB) {
          A.push(p); somaA += p.nota;
        } else if (somaB < somaA) {
          B.push(p); somaB += p.nota;
        } else {
          (Math.random() < 0.5 ? A : B).push(p);
          if (A.includes(p)) somaA += p.nota; else somaB += p.nota;
        }
      }

      // Se nÃºmero Ã­mpar, manda o de menor nota geral para reserva
      const todos = [...A, ...B].sort((a,b)=>a.nota-b.nota);
      const reserva = (todos.length % 2 !== 0) ? [todos[0]] : [];
      if (reserva.length) {
        // remove-o do time em que ele caiu
        const r = reserva[0];
        const idxA = A.findIndex(x=>x.nome===r.nome);
        if (idxA>=0) A.splice(idxA,1); else {
          const idxB = B.findIndex(x=>x.nome===r.nome);
          if (idxB>=0) B.splice(idxB,1);
        }
      }

      return { A, B, reserva };
    }

    function renderTimes({A, B, reserva}){
      clearLists();
      const add = (ul, p) => {
        const li = document.createElement('li');
        li.innerHTML = `<span class="name">${p.nome}</span><span class="tag">Jogador</span>`;
        ul.appendChild(li);
      };
      A.forEach(p=>add(ui.listaA,p));
      B.forEach(p=>add(ui.listaB,p));
      reserva.forEach(p=>{
        const li = document.createElement('li');
        li.innerHTML = `<span class="name">${p.nome}</span><span class="tag">Reserva</span>`;
        ui.listaR.appendChild(li);
      });
      // Se nÃ£o houver reserva, mostra vazio amigÃ¡vel
      if (reserva.length===0) {
        const li = document.createElement('li');
        li.innerHTML = `<span class="name muted">Sem reservas</span>`;
        ui.listaR.appendChild(li);
      }
    }

    function simulateDraw(){
      ui.btnSortear.disabled = true; ui.btnReset.disabled = true;
      ui.status.textContent = 'Sorteandoâ€¦';
      ui.drawerLoading.classList.add('open');

      // LÃª a lista
      const linhas = ui.entradaNomes.value.split(/
?
/);
      const participantes = toParticipantes(linhas);

      setTimeout(() => {
        const resultado = sortearBalanceado(participantes);
        ui.drawerLoading.classList.remove('open');
        ui.status.textContent = 'Times sorteados e equilibrados.';
        ui.times.style.display = 'grid';
        renderTimes(resultado);
        ui.btnReset.disabled = false;
      }, 2200);
    }

    function reset(){
      ui.times.style.display = 'none';
      clearLists();
      ui.status.textContent = 'Pronto para sortear.';
      ui.btnSortear.disabled = false;
      ui.btnReset.disabled = true;
    }

    ui.btnSortear.addEventListener('click', simulateDraw);
    ui.btnReset.addEventListener('click', reset);

    // Inicializa textarea com nomes do prÃ©-cadastro (sem Lucas por padrÃ£o)
    seedEntrada();
  </script>
</body>
</html>